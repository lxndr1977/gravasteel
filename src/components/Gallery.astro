---
import Image from "astro/components/Image.astro";
import "@fancyapps/ui/dist/fancybox/fancybox.css";
import "swiper/css";
import "swiper/css/navigation";

export interface GalleryItem {
  src: any; // pode ser import local ou URL
  alt?: string;
}

export interface Props {
  title?: string;
  subtitle?: string;
  items: GalleryItem[];
}

const {
  title = "Trabalhos Realizados",
  subtitle = "Conheça alguns projetos e peças produzidas em nosso estúdio — qualidade, precisão e acabamento impecável.",
  items = [],
} = Astro.props;
---

<section id="portfolio" class="bg-zinc-100 py-24 border-t border-zinc-100">
  <div class="max-w-7xl mx-auto px-6 lg:px-8">

    <!-- Cabeçalho -->
    <div class="text-center mb-16">
      <h2 class="text-4xl font-bold text-zinc-900 leading-tight tracking-tight ">{title}</h2>
      <p class="mt-4 text-lg text-zinc-600 max-w-2xl mx-auto">
        {subtitle}
      </p>
    </div>

    <!-- Swiper -->
    <div class="relative">
      <div class="swiper gallerySwiper">
        <div class="swiper-wrapper">
          {items.map((item) => (
            <div class="swiper-slide">
              <div class="group relative overflow-hidden rounded-2xl shadow-md  transition-all duration-500">
                <a href={item.src.src ?? item.src} data-fancybox="gallery">
                  <Image
                    src={item.src}
                    alt={item.alt ?? "Imagem do portfólio"}
                    class="w-full h-72 object-cover transition-transform duration-700 group-hover:scale-105"
                    loading="lazy"
                  />
                </a>
              </div>
            </div>
          ))}
        </div>
      </div>

      <!-- Botões -->
      <button
        class="gallery-button-prev hidden lg:flex absolute left-0 top-1/2 -translate-y-1/2 -translate-x-4 z-10 w-12 h-12 items-center justify-center bg-white/90 backdrop-blur-sm rounded-full shadow-lg hover:bg-white transition-colors"
        aria-label="Anterior"
      >
        <svg class="w-6 h-6 text-zinc-800" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
        </svg>
      </button>

      <button
        class="gallery-button-next hidden lg:flex absolute right-0 top-1/2 -translate-y-1/2 translate-x-4 z-10 w-12 h-12 items-center justify-center bg-white/90 backdrop-blur-sm rounded-full shadow-lg hover:bg-white transition-colors"
        aria-label="Próximo"
      >
        <svg class="w-6 h-6 text-zinc-800" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
        </svg>
      </button>
    </div>
  </div>
</section>

<style>
  .gallerySwiper {
    width: 100%;
    padding: 20px 0;
  }

  .swiper-slide {
    height: auto;
    max-width: 480px;
  }

  .gallery-button-prev,
  .gallery-button-next {
    transition: all 0.3s ease;
  }

  .gallery-button-prev.swiper-button-disabled,
  .gallery-button-next.swiper-button-disabled {
    opacity: 0.3;
    cursor: not-allowed;
  }
</style>

<script>
  import Swiper from "swiper";
  import { Navigation } from "swiper/modules";
  import { Fancybox } from "@fancyapps/ui";

  const swiper = new Swiper(".gallerySwiper", {
    modules: [Navigation],
    slidesPerView: 1.15,
    spaceBetween: 24,
    loop: true,
    navigation: {
      nextEl: ".gallery-button-next",
      prevEl: ".gallery-button-prev",
    },
    breakpoints: {
      640: { slidesPerView: 2.25 },
      1024: { slidesPerView: 4.25 },
    },
  });

  // @ts-ignore
  Fancybox.bind('[data-fancybox="gallery"]', {
    Carousel: {
      Thumbs: { showOnStart: false },
    },
    Toolbar: { display: ["close"] },
    dragToClose: true,
  });
</script>

